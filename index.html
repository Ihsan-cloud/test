<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* ... CSS kamu yang sudah lengkap di atas ... */
  </style>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
  <div class="container">
    <h1 class="judul">SWITCH</h1>
    <div class="datetime-container">
      <div class="day-display" id="day-display">Minggu</div>
      <div class="time-display" id="time">00:00:00</div>
    </div>

    <div class="relay-grid">
      <div class="relay" id="relay0" data-name="Lampu" onclick="toggleRelay(0)">Lampu</div>
      <div class="relay" id="relay1" data-name="Kipas" onclick="toggleRelay(1)">Kipas</div>
      <div class="relay" id="relay2" data-name="Nyamuk" onclick="toggleRelay(2)">Nyamuk</div>
      <div class="relay" id="relay3" data-name="Led" onclick="toggleRelay(3)">LED</div>
      <div class="relay" id="relay4" data-name="Stop Kontak" onclick="toggleRelay(4)">Stop Kontak</div>
    </div>

    <div id="notification" class="notification"></div>

    <div id="schedule-setting" class="schedule-setting hidden">
      <div id="schedule-list" class="schedule-list"></div>
      <div class="vertical-text" onclick="closeScheduleList()">TUTUP</div>
      <div id="connection-badge" class="connection-status offline-status">
        <span class="cloud-icon">☁️</span>
        <span id="connection-text">offline</span>
      </div>
    </div>
  </div>

  <script>
    // Firebase Configuration (ganti dengan milikmu)
    var firebaseConfig = {
  apiKey: "AIzaSyB9-JkNWyY2tWDFH3O25I1iK7ANoL6zg-0",
  authDomain: "ihsan-cloud-f3a02.firebaseapp.com",
  databaseURL: "https://ihsan-cloud-f3a02-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "ihsan-cloud-f3a02",
  storageBucket: "ihsan-cloud-f3a02.appspot.com",
  messagingSenderId: "442997712719",
  appId: "1:442997712719:web:de3ef3dc4cbb5b5925873a"
};
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const relayCount = 5;
    const relayPrefix = "relay"; // path di Firebase: relay0, relay1, dst.

    function toggleRelay(index) {
      const relayRef = db.ref(relayPrefix + index);
      relayRef.once("value").then(snapshot => {
        const currentState = snapshot.val();
        const newState = currentState === 1 ? 0 : 1;
        relayRef.set(newState);
        showNotification("Relay " + index + " " + (newState ? "ON" : "OFF"));
      });
    }

    function updateRelayUI(index, state) {
      const relayEl = document.getElementById(relayPrefix + index);
      if (relayEl) {
        if (state === 1) {
          relayEl.classList.add("on");
        } else {
          relayEl.classList.remove("on");
        }
      }
    }

    function showNotification(text) {
      const notif = document.getElementById("notification");
      notif.textContent = text;
      notif.style.display = "block";
      notif.style.animation = "notificationAppear 0.5s ease-out forwards";

      setTimeout(() => {
        notif.style.animation = "notificationClose 0.5s ease-in forwards";
        setTimeout(() => { notif.style.display = "none"; }, 500);
      }, 2000);
    }

    function updateTimeAndDay() {
      const now = new Date();
      const timeEl = document.getElementById("time");
      const dayEl = document.getElementById("day-display");
      const days = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
      const h = now.getHours().toString().padStart(2, '0');
      const m = now.getMinutes().toString().padStart(2, '0');
      const s = now.getSeconds().toString().padStart(2, '0');
      timeEl.textContent = `${h}:${m}:${s}`;
      const day = days[now.getDay()];
      dayEl.textContent = day;
      dayEl.className = "day-display " + (day === "Minggu" ? "sunday" : day === "Jumat" ? "friday" : "other");
    }

    function checkConnectionStatus() {
      const connRef = firebase.database().ref(".info/connected");
      connRef.on("value", (snap) => {
        const online = snap.val() === true;
        const badge = document.getElementById("connection-badge");
        const text = document.getElementById("connection-text");
        if (online) {
          badge.classList.remove("offline-status");
          badge.classList.add("online-status");
          text.textContent = "online";
        } else {
          badge.classList.remove("online-status");
          badge.classList.add("offline-status");
          text.textContent = "offline";
        }
      });
    }

    // Init listeners
    for (let i = 0; i < relayCount; i++) {
      db.ref(relayPrefix + i).on("value", snapshot => {
        updateRelayUI(i, snapshot.val());
      });
    }

    setInterval(updateTimeAndDay, 1000);
    updateTimeAndDay();
    checkConnectionStatus();
  </script>
</body>
</html>